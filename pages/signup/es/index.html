<!doctype html>
<html lang="es">
  <head>
    <title>Deriv | Signup for free</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="" />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;700&amp;family=Ubuntu:wght@400;700&amp;display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        font-family: "Ubuntu", sans-serif;
      }
    </style>
    <link rel="icon" type="image/png" href="../assets/favicon.png" />
  </head>

  <body>
    <div class="flex w-screen justify-center items-center">
      <img
        class="h-14"
        src="https://lh3.googleusercontent.com/ybqdtCnk3Yk5fJJ4Dyy7LpbjqEcLESzxdt6DtvoCB1XZbj4XQx7C_EYO46lb6qEy1M_BpgIng3pfHvpVGiG-vg23dh6cBJj1lg=w3456"
        alt="deriv-logo"
      />
    </div>

    <div
      id="signup-form-container"
      class="grid md:grid-cols-2 max-md:grid-rows-[auto_1fr] gap-8 max-w-[77rem] 2xl:w-[80%] xl:w-[84%] md:w-[90%] w-[95%] mx-auto pt-32 md:items-center"
    >
      <div class="flex flex-col gap-4">
        <h1 class="text-2xl text-center text-[#414652] font-bold">
          Unique trade types. Hundreds of instruments. Financial and derived markets.
        </h1>
        <h2 class="max-md:hidden text-lg xl:text-xl text-center text-[#414652]">Trade anywhere, anytime.</h2>
        <p class="max-md:hidden text-sm xl:text-base text-center text-[#414652]">
          Ready to join over 2.5 million traders who have chosen Deriv as their trusted broker? Enter your email address
          to create a free demo account.
        </p>
      </div>
      <div class="gap-4 flex flex-col rounded-lg md:shadow-[0_0_24px_rgba(0,0,0,.05)] max-md:px-3 md:p-10">
        <h2 class="text-2xl text-[#414652] font-bold">Sign up</h2>
        <p class="text-base text-[#414652] md:hidden">Enter your email address to create a free demo account.</p>

        <p class="text-base text-[#414652] max-md:hidden">Enter your email address to begin</p>

        <input
          class="email-input border border-[#d6dadb] h-10 px-5 rounded-2xl text-sm"
          id="email_input_n1"
          type="text"
          placeholder="E-mail"
        />
        <div class="flex items-center gap-3 py-4">
          <input type="checkbox" id="ckbx_n1" />
          <label for="ckbx_n1"
            >I agree to the
            <a
              class="element__translation_string__element"
              href="https://drive.google.com/file/d/1G7boJkXRsO5okMp3JBdfJjB2K0vUal5y"
              target="_blank"
              style="color: #ff444f !important"
              >terms and conditions</a
            >.</label
          >
        </div>
        <button
          id="myBtn_n1"
          class="text-xs text-white bg-[#ff444f] h-10 rounded-2xl disabled:opacity-[0.32] hover:opacity-70"
          style="font-weight: 700"
          type="button"
        >
          Create demo account
        </button>
        <p class="text-[10px] xl:text-xs leading-4 xl:leading-5 text-[#414652b2]">
          By pressing "Create demo account", you confirm that you are 18 or older. You understand that we may use your
          email address to send you information about Deriv products and services as well as market news. You can always
          unsubscribe from these emails in your account settings. For more information, please take a look at Deriv's
          <a
            class="element__translation_string__element"
            href="https://drive.google.com/file/d/15UFkj1v2BXJyhzFWBMQRjJShoPtVJf8v/view"
            target="_blank"
            style="color: #ff444f !important"
            >Security and privacy</a
          >.
        </p>
        <div class="grid grid-cols-3 items-center py-2">
          <div class="w-full border-b border-[#d6dadb]"></div>
          <span class="w-full text-sm text-[#414652b2] text-center whitespace-nowrap">Or sign up with</span>
          <div class="w-full border-b border-[#d6dadb]"></div>
        </div>
        <button
          data-platform="google"
          style="font-weight: 700"
          class="flex items-center justify-center w-full h-12 gap-[0.4rem] text-xs font-bold bg-white border border-[#d6dadb] rounded-2xl hover:opacity-70 social-media-login"
        >
          <img
            class="h-6 w-6"
            height="24px"
            width="24px"
            alt="google"
            src="https://static.deriv.com/email/images/icons/social-google.png"
          />
          <span>Google</span>
        </button>
        <button
          data-platform="facebook"
          style="font-weight: 700"
          class="flex items-center justify-center w-full h-12 gap-[0.4rem] text-xs font-bold bg-[#1877f2] text-white rounded-2xl hover:opacity-70 social-media-login"
        >
          <img
            class="h-6 w-6"
            height="24px"
            width="24px"
            alt="facebook"
            src="https://static.deriv.com/email/images/icons/social-facebook-blue.png"
          />
          <span>Facebook</span>
        </button>
        <button
          data-platform="apple"
          style="font-weight: 700"
          class="flex items-center justify-center w-full h-12 gap-[0.4rem] text-xs font-bold bg-black text-white rounded-2xl hover:opacity-70 social-media-login"
        >
          <img
            class="h-6 w-6"
            height="24px"
            width="24px"
            alt="apple"
            src="https://static.deriv.com/email/images/icons/social-apple-white.png"
          />
          <span>Apple</span>
        </button>
      </div>
    </div>
    <footer class="mt-12">
      <h1 id="ls-test-feature-flag" class="text-2xl text-center text-[#414652]">This is Default</h1>
    </footer>

    <script>
      const templates = {
        lsTestFeatureOn: `The Feature is on`,
        lsTestFeatureOff: `This is Default`,
      };

      const submit_btn_n1 = document.getElementById("myBtn_n1");
      const ckbx_n1 = document.getElementById("ckbx_n1");
      const email_field_n1 = document.getElementById("email_input_n1");
      const RUDDERSTACK_URL = "https://deriv-dataplane.rudderstack.com";
      const RUDDERSTACK_KEY = "1lN3tsFD2nruGFgM5F074DC2hMB";

      rudderanalytics = window.rudderanalytics = [];
      const methods = [
        "load",
        "page",
        "track",
        "identify",
        "alias",
        "group",
        "ready",
        "reset",

        "setAnonymousId",
        "getAnonymousId",
      ];
      for (var i = 0; i < methods.length; i++) {
        var method = methods[i];
        rudderanalytics[method] = (function (methodName) {
          return function () {
            rudderanalytics.push([methodName].concat(Array.prototype.slice.call(arguments)));
          };
        })(method);
      }
      rudderanalytics.load(RUDDERSTACK_KEY, RUDDERSTACK_URL);

      ckbx_n1.addEventListener("click", fckbx_n1);
      submit_btn_n1.addEventListener("click", f_submit_btn_n1);
      email_field_n1.addEventListener("keyup", f_email_input_errmsg_n1);

      function f_email_input_errmsg_n1() {
        const email = email_field_n1.value;
        if (is_emailValid(email)) {
        }
      }

      function fckbx_n1() {
        if (ckbx_n1.checked == true) {
        }
      }

      const getVerifyEmailRequest = (formatted_email) => {
        const fields = [
          "date_first_contact",
          "signup_device",
          "gclid",
          "utm_source",
          "utm_ad_id",
          "utm_adgroup_id",
          "utm_adrollclk_id",
          "utm_campaign",
          "utm_campaign_id",
          "utm_content",
          "utm_fbcl_id",
          "utm_gl_client_id",
          "utm_medium",
          "utm_msclk_id",
          "utm_term",
        ];

        let url_parameters = {};

        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);

        fields.map((fld) => {
          const fld_value = urlParams.get(fld);

          if (fld_value) {
            url_parameters[fld] = fld_value;
          }
        });

        return {
          verify_email: formatted_email,
          type: "account_opening",
          url_parameters,
        };
      };

      const initializeWebSocket = () => {
        window.ws = new WebSocket("wss://blue.derivws.com/websockets/v3?app_id=16929&l=en&brand=deriv");

        window.ws.onmessage = (message) => {
          const response = JSON.parse(message.data);

          if (response.msg_type === "error") {
            window.ws.close();
          }

          if (response.msg_type === "verify_email") {
            const lang = document.querySelector("html").getAttribute("lang");
            const email = response.echo_req.verify_email;

            const newUrl = `${window.location.origin}/verify-email/${lang}`;
            const searchParams = new URLSearchParams({ email });
            window.location.assign(`${newUrl}?${searchParams}`);
          }
        };

        window.ws.onclose = () => setTimeout(() => initializeWebSocket(), 1000);
      };

      async function f_submit_btn_n1() {
        const email = email_field_n1.value;
        if (is_emailValid(email) && ckbx_n1.checked == true) {
          const bro = await rudderanalytics.track("signup_redirect_from_lead_pages");
          console.log("track signup_redirect_from_lead_pages", bro);
          const verify_email_req = getVerifyEmailRequest(email);
          console.log(verify_email_req);
          window.ws.send(JSON.stringify(verify_email_req));
        }
      }

      function is_emailValid(email) {
        if (/^\w+([!#$%&'*+-/=?^_`{|}~\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(email)) return true;
        return false;
      }

      /// social login
      const getDataLink = (data) => {
        let data_link = "";
        Object.keys(data).forEach((elem) => {
          data_link += `&${elem}=${data[elem]}`;
        });
        return data_link;
      };

      const loginUrl = (platform) => {
        const social_signup = platform ? `&social_signup=${platform}` : "";
        const lang = "hi";
        return `https://oauth.deriv.com/oauth2/authorize?app_id=16929&l=${lang}&brand=deriv&platform=${social_signup}`;
      };

      window.onload = async () => {
        document.querySelectorAll(".social-media-login").forEach((e) => {
          e.addEventListener("click", () => {
            const platform = e.getAttribute("data-platform");
            window.location.href = loginUrl(platform);
          });
        });

        // Create a GrowthBook instance
        const gb = new growthbook.GrowthBook({
          apiHost: "https://cdn.growthbook.io",
          clientKey: "sdk-jJ33wcv3oAB2xvxM",
          enableDevMode: true,
          subscribeToChanges: true,
          attributes: {
            id: "123",
            country: "US",
          },
          trackingCallback: (experiment, result) => {
            console.log("Experiment Viewed", {
              experimentId: experiment.key,
              variationId: result.key,
            });
          },
        });

        await gb.loadFeatures();

        const lsTestFeature = gb.getFeatureValue("ls-test-feature", {
          key: "no-value",
        });
        console.log(lsTestFeature.key);

        const heading = document.getElementById("ls-test-feature-flag");

        if (lsTestFeature.key === "no-value") {
          heading.innerHTML = templates.lsTestFeatureOff;
        } else {
          heading.innerHTML = templates.lsTestFeatureOn;
        }
      };

      initializeWebSocket();
    </script>
    <script src="https://cdn.rudderlabs.com/v1.1/rudder-analytics.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@growthbook/growthbook/dist/bundles/index.js"></script>
  </body>
</html>
